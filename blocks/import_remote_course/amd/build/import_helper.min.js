define(["jquery","jqueryui","core/ajax","core/str","core/notification"],function(a,b,c,d,e){function f(){a("#progres").modal("show")}var g=function(){};return g.prototype.init=function(b){a(".activityitem").on("dragstart",function(b){a("[id^=section]").addClass("highlight"),b.originalEvent.dataTransfer.setData("text/html",b.target.id)}),a(".activityitem").on("dragend",function(b){a("[id^=section]").removeClass("highlight")}),a(".sectionitem").on("dragstart",function(b){a(".course-content").addClass("drop"),b.originalEvent.dataTransfer.setData("text/html",b.target.id)}),a(".sectionitem").on("dragend",function(b){a(".course-content").removeClass("drop")}),a("#newitems").click(function(){a("#newactivitieslist").toggleClass("hidden")}),a("#updateitems").click(function(){a("#updatedactivites").toggleClass("hidden")}),a("#newsection").click(function(){a("#newsectionlist").toggleClass("hidden")}),a("li.section").on("drop dragover dragleave",function(d){switch(d.type){case"dragover":d.preventDefault(),a(d.target).closest("[id^=section-]").addClass("drop");break;case"dragleave":a(d.target).closest("[id^=section-]").removeClass("drop");break;case"drop":var e=d.originalEvent.dataTransfer.getData("text/html");if(e.indexOf("meta")>-1&&(e=e.replace(/^\D+/g,""),e=e.substring(3)),!a("#"+e).hasClass("activityitem")&&!a("#"+e).hasClass("sectionitem"))break;if(f(),a("#"+e).hasClass("activityitem")){var g=c.call([{methodname:"block_import_remote_course_activity",args:{cmid:e,courseid:b,sectionid:a(this).attr("id").replace("section-","")}}]);g[0].done(function(a){"success"==a.status&&location.reload()});break}if(a("#"+e).hasClass("sectionitem")){var g=c.call([{methodname:"block_import_remote_course_section",args:{cmid:e,courseid:b}}]);g[0].done(function(a){"success"==a.status&&location.reload()});break}}}),a("#newconfirmyes").click(function(){var f=c.call([{methodname:"block_import_remote_course_delete_act",args:{course_id:b,type:"new"}}]);f[0].done(function(b){1==b.result?location.reload():(editaPresent=d.get_string("errordelete","block_import_remote_course"),a.when(editaPresent).done(function(a){text=a}),editaPresent=d.get_string("confirm","core"),a.when(editaPresent).done(function(a){confirm=a}),e.alert("",text,confirm))})}),a("#updateconfirmyes").click(function(){var f=c.call([{methodname:"block_import_remote_course_delete_act",args:{course_id:b,type:"update"}}]);f[0].done(function(b){1==b.result?location.reload():(editaPresent=d.get_string("errordelete","block_import_remote_course"),a.when(editaPresent).done(function(a){text=a}),editaPresent=d.get_string("confirm","core"),a.when(editaPresent).done(function(a){confirm=a}),e.alert("",text,confirm))})}),a("#newsectionsconfirmyes").click(function(){var f=c.call([{methodname:"block_import_remote_course_delete_act",args:{course_id:b,type:"section"}}]);f[0].done(function(b){1==b.result?location.reload():(editaPresent=d.get_string("errordelete","block_import_remote_course"),a.when(editaPresent).done(function(a){text=a}),editaPresent=d.get_string("confirm","core"),a.when(editaPresent).done(function(a){confirm=a}),e.alert("",text,confirm))})})},new g});