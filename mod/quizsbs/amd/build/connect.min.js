define(["jquery","core/ajax","core/notification","core/templates"],function(a,b,c,d){var e=function(){};return e.prototype.init=function(){a('[name="content"]').click(function(c){var e=c.target,f=[{methodname:"mod_quizsbs_load_connected_content",args:{id:a(e).val()}},{methodname:"mod_quizsbs_get_content_preview",args:{id:a(e).val()}}],g=b.call(f);g[0].done(function(c){var e=d.render("mod_quizsbs/connectsubject",c);e.done(function(b){a("#subjectlist").html(b),a("#subject"+a('[name="content"]:checked').data("subject")).attr("checked","checked")}),e=d.render("mod_quizsbs/questionlist",c),e.done(function(c){a("#questionlist").html(c),a(".question").click(function(c){var d=c.target,e=[{methodname:"mod_quizsbs_get_question_preview",args:{id:a(d).attr("id"),cmid:a("#contentslist").data("cmid")}}],f=b.call(e);f[0].done(function(b){a("#question_preview").html(b.questionhtml)})})})}),g[1].done(function(b){a("#htmlcontent").html(""),a("#csscontent").html(""),a("#javascriptcontent").html("");for(var c in b)switch(b[c].type){case 0:a("#htmlcontent").html(b[c].content);break;case 3:a("#csscontent").html("<style>"+b[c].content+"</style>");break;case 2:a("#javascriptcontent").html("<script>require(['jquery'], function($) {"+b[c].content+"});</script>")}})}),a("#connectsubject").click(function(){var d=[];a('input[type="checkbox"]:checked').each(function(b,c){d.push(a(c).val())});var e=[{methodname:"mod_quizsbs_add_question_to_content",args:{ids:d,contentid:a('[name="content"]:checked').val(),cmid:a("#contentslist").data("cmid")}}],f=b.call(e);e=[{methodname:"mod_quizsbs_add_subject_to_content",args:{id:a('input[name="subject"]:checked').val(),contentid:a('[name="content"]:checked').val(),cmid:a("#contentslist").data("cmid")}}],f=b.call(e),f[0].done(function(){a('[name="content"]:checked').data("subject",a('input[name="subject"]:checked').val()),c.addNotification({message:M.util.get_string("changessuccessfulsave","mod_quizsbs"),type:"success"}),a("html, body").animate({scrollTop:a("#user-notifications").offset().top},"fast")})})},new e});